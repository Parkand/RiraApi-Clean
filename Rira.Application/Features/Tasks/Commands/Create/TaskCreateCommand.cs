using MediatR;
using Rira.Application.Common;
using Rira.Domain.Enums;
using TaskStatus = Rira.Domain.Enums.TaskStatus;

namespace Rira.Application.Features.Tasks.Commands.Create
{
    // 🎯 فرمان (Command) ایجاد تسک جدید در سیستم Rira — مبتنی بر الگوی CQRS و MediatR
    // ----------------------------------------------------------------------------------
    // این کلاس نمایانگر یک "درخواست نوشتنی" در الگوی CQRS است که برای افزودن رکورد جدید
    // (در اینجا Task یا وظیفه) به پایگاه داده استفاده می‌شود.
    //
    // 📦 جایگاه در معماری:
    //   ▫ لایه Application → Features → Tasks → Commands → Create
    //   ▫ ساختار CQS شامل: Command + Handler + Validator
    //
    // 📬 وظیفه:
    //   ▫ توسط Controller ارسال می‌شود.
    //   ▫ در Pipeline مربوط به MediatR پردازش می‌گردد.
    //   ▫ منطق ثبت تسک جدید در Handler متناظر (TaskCreateCommandHandler) اجرا می‌شود.
    //
    // 🧩 خروجی:
    //   ResponseModel<int>
    //   ⮕ عدد بازگشتی از نوع int که شناسه (Id) تسک جدید ایجاد شده را برمی‌گرداند.
    //
    // 💡 ویژگی‌ها به گونه‌ای تعریف شده‌اند که داده‌ی خام از سمت کاربر را نگه‌داری کنند،
    //     و در Handler Validation و Mapping به Task Entity انجام خواهد شد.
    public class TaskCreateCommand : IRequest<ResponseModel<int>>
    {
        // 📝 عنوان تسک — فیلد ضروری و کلیدی
        // ----------------------------------------------------------------
        // توضیح: هر تسک باید حداقل یک عنوان معنی‌دار داشته باشد.
        // اعتبارسنجی این فیلد (خالی نبودن، حداکثر طول و غیره)
        // در کلاس Validator (TaskCreateValidator) بررسی می‌شود.
        public string Title { get; set; } = string.Empty;

        // 📄 توضیحات (اختیاری)
        // ----------------------------------------------------------------
        // توضیح: امکان ثبت توضیح برای تسک وجود دارد، برای مثال
        // تعیین جزئیات، مهلت، یا وظیفه‌های فرعی.
        public string? Description { get; set; }

        // ⚙️ وضعیت فعلی تسک (TaskStatus Enum)
        // ----------------------------------------------------------------
        // مقادیر ممکن: Pending, InProgress, Completed
        // مقدار پیش‌فرض: Pending
        // این فیلد وضعیت تسک را از لحظه‌ی ایجاد مشخص می‌کند
        // و در ادامه توسط TaskUpdateCommand قابل تغییر است.
        public TaskStatus Status { get; set; } = TaskStatus.Pending;

        // 🚦 اولویت تسک (TaskPriority Enum)
        // ----------------------------------------------------------------
        // مقادیر ممکن: Low, Medium, High, Critical
        // مقدار پیش‌فرض: Medium
        // هدف آن است که هر تسک در فرآیند کاری بتواند وزن یا اهمیت خود را مشخص کند.
        public TaskPriority Priority { get; set; } = TaskPriority.Medium;

        // ⏰ تاریخ سررسید تسک (DueDate)
        // ----------------------------------------------------------------
        // فرمت پیشنهادی: yyyy/MM/dd
        // در Handler یا Validator اطمینان حاصل می‌شود مقدار معتبر و آینده‌نگر باشد.
        // این فیلد معمولاً به‌صورت رشته ذخیره می‌شود تا از فرمت‌های محلی مختلف پشتیبانی کند.
        public string DueDate { get; set; } = string.Empty;
    }

    // ===========================================================================================
    // 📘 خلاصه آموزشی (RiraDocs Teaching Edition)
    // -------------------------------------------------------------------------------------------
    // 🔹 Command در CQRS:
    //     ▫ فقط برای "تغییر دادن وضعیت سیستم" به‌کار می‌رود (ایجاد، ویرایش، حذف).
    //     ▫ خود Command دادهٔ ورودی را حمل می‌کند ولی هیچ منطق تجاری ندارد.
    //
    // 🔹 Handler مربوطه:
    //     ▫ TaskCreateCommandHandler → مسئول اعمال منطق ایجاد تسک جدید در DB.
    //     ▫ تزریق IAppDbContext و استفاده از AutoMapper برای نگاشت داده‌ها.
    //
    // 🔹 ResponseModel<int>:
    //     ▫ قالب عمومی پاسخ در سامانهٔ Rira برای برگرداندن نتیجه به Controller.
    //     ▫ Success → شامل Id تسک تازه ایجاد شده.
    //     ▫ Fail / ValidationError → حاوی پیام و وضعیت خطا.
    //
    // 🔹 نکته معماری:
    //     در پروژه‌های Clean Architecture و CQRS، Command‌ها معمولاً ساده و خالص (POCO) نگه‌داری می‌شوند.
    //     هیچ وابستگی تکنیکی یا منطقی (Dependency) به جز تعریف داده ندارند.
    //
    // 🔹 هیچ تغییری در منطق یا اجرای کد اعمال نشده — فقط مستندسازی فارسی آموزشی افزوده شد.
    // ===========================================================================================
}
