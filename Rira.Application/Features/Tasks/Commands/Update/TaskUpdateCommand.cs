using MediatR;
using Rira.Application.Common;
using Rira.Domain.Enums;
using TaskStatus = Rira.Domain.Enums.TaskStatus;

namespace Rira.Application.Features.Tasks.Commands.Update
{
    // 🧩 فرمان (Command) به‌روزرسانی تسک — Update Task Command
    // -------------------------------------------------------------------
    // این کلاس مسئول حمل داده‌هایی است که برای "به‌روزرسانی" تسک نیاز داریم.
    //
    // 📌 جایگاه معماری:
    //     در الگوی CQRS، عملیات تغییر‌دهنده داده (Create, Update, Delete)
    //     در بخش Command ذخیره می‌شوند و هرکدام Handler اختصاصی دارند.
    //
    // ⚙️ روند:
    //     ▪ Controller مربوطه، شیء TaskUpdateCommand را با داده‌های ورودی دریافت می‌کند.
    //     ▪ MediatR آن را به TaskUpdateCommandHandler ارسال می‌کند.
    //     ▪ Handler بر اساس Id، رکورد را یافته و مقادیر جدید را روی آن اعمال می‌نماید.
    //
    // 🧠 تفاوت با TaskCreateCommand:
    //     ▫ CreateCommand رکورد جدید می‌سازد.
    //     ▫ UpdateCommand رکورد موجود را اصلاح می‌کند.
    //
    // 📦 خروجی Handler:
    //     ResponseModel<int>  →  شامل وضعیت، پیام، کد پاسخ، و شناسه تسک به‌روزشده.
    public class TaskUpdateCommand : IRequest<ResponseModel<int>>
    {
        // 🆔 شناسه تسک مورد نظر برای به‌روزرسانی
        // -------------------------------------------------------------------
        // Handler ابتدا با این Id رکورد را در دیتابیس جست‌وجو می‌کند.
        // در صورت عدم یافتن، پیام "NotFound" بازمی‌گرداند.
        public int Id { get; set; }

        // 🧾 عنوان تسک
        // -------------------------------------------------------------------
        // اجباری است و حداکثر طول آن معمولاً 150 کاراکتر است
        // (توسط Validator کنترل می‌شود نه در این فایل).
        public string Title { get; set; } = string.Empty;

        // 📋 توضیحات تسک (اختیاری)
        // -------------------------------------------------------------------
        // ممکن است خالی باشد اما اگر داده شود باید زیر 500 کاراکتر باشد.
        public string? Description { get; set; }

        // 🔄 وضعیت کاری (TaskStatus)
        // -------------------------------------------------------------------
        // نوع شمارشی (Enum) از Rira.Domain.Enums
        // معمولاً شامل Pending, InProgress, Completed و غیره است.
        public TaskStatus Status { get; set; }

        // 🚩 اولویت (TaskPriority)
        // -------------------------------------------------------------------
        // نوع شمارشی دیگر برای مشخص‌کردن حساسیت یا سطح اهمیت تسک.
        // مقادیر معمول: Low, Medium, High, Urgent.
        public TaskPriority Priority { get; set; }

        // 📅 تاریخ سررسید (DueDate)
        // -------------------------------------------------------------------
        // به‌صورت رشته ذخیره می‌شود، ولی Validator باید بررسی کند که
        // با فرمت yyyy/MM/dd باشد و تاریخ گذشته نباشد.
        public string DueDate { get; set; } = string.Empty;
    }

    // ===========================================================================================
    // 📘 خلاصه آموزشی (RiraDocs Teaching Edition)
    // -------------------------------------------------------------------------------------------
    // 🔹 نقش در CQRS:
    //     Command برای انتقال داده‌های ورودی جهت "تغییر وضعیت" در سیستم.
    //     Handler متناظر (TaskUpdateCommandHandler) منطق واقعی به‌روزرسانی را اجرا می‌کند.
    //
    // 🔹 مشارکت‌کنندگان در چرخه:
    //     ▫ Controller → ارسال Command
    //     ▫ MediatR → فراخوانی Handler مناسب
    //     ▫ Handler → تغییر رکورد در DbContext و ذخیره نتیجه
    //
    // 🔹 ساختار پاسخ:
    //     ResponseModel<int> → استفاده از قالب پاسخ استاندارد پروژه Rira برای وضوح و سادگی API.
    //
    // 🔹 نکات آموزشی:
    //     ▫ در Clean Architecture، Commandها فقط شامل داده و تعریف قرارداد (Request) هستند.
    //       هیچ منطق بیزنس در آن‌ها نباید وجود داشته باشد.
    //     ▫ اعتبارسنجی داده‌ها در فایل جداگانه TaskUpdateCommandValidator انجام می‌شود.
    //     ▫ منطق واقعی در TaskUpdateCommandHandler پیاده‌سازی می‌شود.
    //
    // 🔹 هدف آموزشی:
    //     نمایش ساختار لایه Application در RiRa.Api و درک جریان کامل "Update Task".
    //
    // 🔹 بدون هیچ تغییر در منطق اجرایی — فقط اضافه شدن توضیحات آموزشی فارسی.
    // ===========================================================================================
}
